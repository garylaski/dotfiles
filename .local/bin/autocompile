#!/bin/sh

# Compile and run a file based on extension.

file=$(readlink -f "$1")
dir=${file%/*}
base="${file%.*}"
ext="${file##*.}"

cd "$dir" || exit 1

case "$ext" in
	c);;
	cpp);;
	h);;
	ms) preconv "$file" | refer -PS -e | groff -me -ms -kept -T pdf > "$base".pdf ;;
	java) javac "$file" ;;
	*) exit 1 ;;
esac

if [ $# -eq 1 ]; then
	exit 0
fi
case "$ext" in
	c);;
	cpp);;
	h);;
	ms) setsid -f zathura "$base".pdf ;;
	java) java "$base" ;;
	*) exit 1 ;;
esac
